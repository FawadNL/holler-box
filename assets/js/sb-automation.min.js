(function(c,a,d,e){var b={};b.init=function(){b.newVisitor=false;b.noteInteracted=false;b.noteHidden=false;b.checkCookie();if(c.sbAutoVars.active){b.doActive(c.sbAutoVars.active);
}};b.doActive=function(g){for(var f=0;f<g.length;f++){b.doChecks(g[f]);}};b.doChecks=function(k){var h=a.getElementById("sb-"+k);if(!h){return;}var j=c.sbAutoVars[k];
if(!j.visitor){return;}if(j.visitor==="new"&&b.newVisitor!=true){return;}if(j.visitor==="returning"&&b.newVisitor!=false){return;}var g=b.getCookie("sb_"+k+"_shown");
if(j.showSettings==="hide_for"&&g==="true"){return;}else{if(j.showSettings==="hide_for"&&g===""){var i=(j.hideForDays?parseInt(j.hideForDays):1);b.setCookie("sb_"+k+"_shown","true",i);
}}if(j.showSettings==="interacts"&&b.getCookie("sb_"+k+"_int")!=""){return;}b.floatingBtn=a.getElementById("sb-floating-btn");b.noteListeners(k);if(j.bgColor){h.style.backgroundColor=j.bgColor;
}if(j.btnColor1){d("#sb-"+k+" .sb-email-btn, #sb-floating-btn").css("background-color",j.btnColor1);}if(j.display_when!="scroll"){var f=(j.display_when==="delay"?parseInt(j.delay):0);
setTimeout(function(){b.showNote(k);},f*1000);}else{b.detectScroll(k);}};b.checkCookie=function(){if(b.getCookie("sb_visit")===""){b.setCookie("sb_visit",Date.now(),parseInt(c.sbAutoVars.expires));
b.setCookie("sb_new","true",1);b.newVisitor=true;}else{if(b.getCookie("sb_new")!=""){b.newVisitor=true;}}};b.noteListeners=function(f){d("body").on("click",".sb-close",b.hideItem).on("click","#sb-floating-btn",b.btnClick).on("click",".sb-interaction",b.interactionLink).on("click",".sb-full-side",b.fullSide).on("click",".sb-text i",b.sendText).on("submit",".sb-notification-box form",b.handleForms);
d(".sb-text-input").on("keypress",b.submitChatTextOnEnter);if(c.sbAutoVars[f].emailProvider!="mc"){d("body").on("click","#sb-"+f+" .sb-email-btn",b.emailSubmitClick);
d("#sb-"+f+" .sb-email-input").on("keypress",b.submitEmailOnEnter);}};b.detectScroll=function(f){d(c).scroll(b.debounce(function(){var h=d(c).scrollTop(),i=d(a).height(),g=d(c).height();
var j=0.5;if((h/(i-g))>j&&!b.show["sb-"+f]){b.showNote(f);b.show["sb-"+f]=true;}},250));};b.fullSide=function(g){g.stopImmediatePropagation();var h=d(g.target).closest(".sb-notification-box").attr("id");
var f=d("#"+h);f.toggleClass("sb-full-side");f.toggleClass("sb-minimizing",!f.hasClass("sb-full-side"));setTimeout(function(){f.removeClass("sb-minimizing");
},1000);return false;};b.showNote=function(i){var f=c.sbAutoVars[i];var h=a.getElementById("sb-"+i);d("#sb-"+i+" .sb-first-row").html(f.content);if(f.hideFirst==="true"||b.getCookie("sb-"+i+"_hide")==="true"){b.transitionOut(h);
if(f.hideBtn!="1"&&f.position!="sb-banner-top"){b.transitionIn(b.floatingBtn);}}else{b.transitionIn(h);if(f.hideBtn!="1"&&f.position!="sb-banner-top"){b.transitionOut(b.floatingBtn);
}}if(f.showEmail==="1"){b.show(a.querySelector("#sb-"+i+" .sb-note-optin"));var g=a.querySelector("#sb-"+i+" .sb-email-input");if(!g){return;}g.setAttribute("placeholder",f.placeholder);
d(".sb-away-msg").remove();d("#sb-"+i+" .sb-email-row").prepend('<span class="sb-away-msg">'+f.optinMsg+"</span>");d("#sb-"+i).addClass("has-optin");}if(f.hideBtn==="1"){b.hide(b.floatingBtn);
}if(f.position==="sb-banner-top"&&b.getCookie("sb-"+i+"_hide")!="true"){b.toggleBnrMargin(i);}if(f.hide_after==="delay"){setTimeout(function(){b.transitionOut(h);
},parseInt(f.hide_after_delay)*1000);}};b.setCookie=function(g,j,h){var i=new Date();i.setTime(i.getTime()+(h*24*60*60*1000));var f="expires="+i.toUTCString();
a.cookie=g+"="+j+";"+f+";path=/";return j;};b.getCookie=function(h){var g=h+"=";var k=decodeURIComponent(a.cookie);var f=k.split(";");for(var j=0;j<f.length;
j++){var l=f[j];while(l.charAt(0)==" "){l=l.substring(1);}if(l.indexOf(g)==0){return l.substring(g.length,l.length);}}return"";};b.debounce=function(g,f){var h=null;
return function(){var j=this,i=arguments;clearTimeout(h);h=setTimeout(function(){g.apply(j,i);},f);};};b.toggleBnrMargin=function(h,g){if(g&&g===true){d("body").css("margin-top","");
}else{var f=d("#sb-"+h).outerHeight();d("body").css("margin-top",f);}};b.hideItem=function(g){g.stopImmediatePropagation();var f=d(g.target).closest(".sb-notification-box");
var h=f.attr("id").split("-")[1];b.toggleHide(h);if(f.hasClass("sb-banner-top")){b.toggleBnrMargin(h,true);}return false;};b.btnClick=function(f){f.stopImmediatePropagation();
var g=d(this).data("id");b.toggleHide(g);};b.toggleHide=function(g){var f=b.getCookie("sb-"+g+"_hide");if(f==="true"){b.setCookie("sb-"+g+"_hide","true",-1);
}else{b.setCookie("sb-"+g+"_hide","true",1);setTimeout(function(){b.clearChat();},1000);}b.showNote(g);};b.transitionIn=function(f){f.style.display="block";
setTimeout(function(){d(f).addClass("sb-transition-in").removeClass("sb-hide");},1);setTimeout(function(){d(f).removeClass("sb-transition-in").addClass("sb-show");
},100);};b.transitionOut=function(f){d(f).addClass("sb-transition-out").removeClass("sb-show");setTimeout(function(){d(f).removeClass("sb-transition-out").addClass("sb-hide");
d(f).css("display","");},200);};b.show=function(f){f.style.display="block";d(f).removeClass("sb-hide").addClass("sb-show");};b.hide=function(f){d(f).removeClass("sb-show").addClass("sb-hide");
d(f).css("display","");};b.checkExistingMsg=function(){var h=c.localStorage.getItem("sb-full-msg");if(h&&h!=""){var g=h.split("/n");for(var f=0;f<g.length;
f++){d("#"+b.activeID+" .sb-box-rows").append('<div class="sb-row sb-visitor-row">'+g[f]+"</div>");}b.showEmailSubmit();}};b.submitChatTextOnEnter=function(f){if(f.target.value&&f.target.value!=""&&f.keyCode==13){b.submitText(f.target.value);
f.target.value="";}};b.submitEmailOnEnter=function(f){if(f.target.value&&f.target.value!=""&&f.keyCode==13){var g=d(f.target).closest(".sb-notification-box").attr("id").split("-")[1];
b.emailSubmitted(g);}};b.sendText=function(f){f.stopImmediatePropagation();var g=d("#"+b.activeID+" .sb-text-input").val();if(g&&g!=""){b.submitText(g);
d("#"+b.activeID+" .sb-text-input").val("").focus();}};b.submitText=function(g){var f=c.localStorage.getItem("sb-full-msg");d("#"+b.activeID+" .sb-box-rows").append('<div class="sb-row sb-visitor-row">'+g+"</div>");
if(f){f+="\n"+g;}else{f=g;}c.localStorage.setItem("sb-full-msg",f);setTimeout(function(){b.showEmailSubmit();},5000);};b.showEmailSubmit=function(){var f=d("#"+b.activeID+" .sb-email-row");
if(f.hasClass("sb-show")){return;}f.removeClass("sb-hide").addClass("sb-show");f.prepend('<span class="sb-away-msg">'+b.activeOptions.optinMsg+"</span>");
d("#"+b.activeID+" .sb-email-input").focus();};b.emailSubmitClick=function(f){f.stopImmediatePropagation();var g=d(f.target).closest(".sb-notification-box").attr("id").split("-")[1];
console.log(g);b.emailSubmitted(g);};b.emailSubmitted=function(h){var f=d("#sb-"+h+" .sb-email-input").val();if(!f){return;}if(f.indexOf("@")===-1||f.indexOf(".")===-1){alert("Something is wrong with your email, please try again.");
return;}if(d("#sb-"+h+" input[name=sb_hp]").val()!=""){return;}if(c.sbAutoVars[h].emailProvider==="ck"){b.ckSubscribe(f,h);return;}var g=c.localStorage.getItem("sb-full-msg");
b.sendMsg(f,g,h);};b.ckSubscribe=function(g,j){var f=c.sbAutoVars[j];var i=d("#sb-"+j+" .ck-form-id").val();var h="https://api.convertkit.com/v3/forms/"+i+"/subscribe";
d.ajax({method:"POST",url:h,data:{email:g,api_key:f.ckApi}}).done(function(k){console.log(k);b.showConfirmation(j);d("#sb-"+j+" .sb-email-row").hide();
b.interacted(j);}).fail(function(k){d("#sb-"+j+" .sb-email-row").prepend("There seems to be a problem, can you try again?");console.log(k);});};b.sendMsg=function(f,g,h){d.ajax({method:"GET",url:c.sbAutoVars.ajaxurl,data:{email:f,id:h,msg:g,action:"sb_send_email",nonce:c.sbAutoVars.sbNonce}}).done(function(i){console.log(i);
b.clearChat();b.showConfirmation(h);b.interacted(h);}).fail(function(i){console.log(i);});};b.clearChat=function(){if(!d(b.chatBox).hasClass("sb-hide")){c.localStorage.removeItem("sb-full-msg");
d("#"+b.activeID+" .sb-visitor-row, #"+b.activeID+" .sb-away-msg").remove();}b.hide(b.noteOptin);};b.interactionLink=function(f){f.stopImmediatePropagation();
var g=d(this).data("id");b.interacted(g);};b.interacted=function(g){var f={action:"sb_track_event",nonce:c.sbAutoVars.sbNonce,id:g};d.ajax({method:"GET",url:c.sbAutoVars.ajaxurl,data:f}).done(function(h){console.log(h);
}).fail(function(h){console.log(h);});b.setCookie("sb_"+g+"_int","true",1);};b.handleForms=function(f){var g=d(f.target).closest(".sb-notification-box").attr("id").split("-")[1];
setTimeout(function(){b.interacted(g);d(f.target).closest(".sb-email-row").hide();b.showConfirmation(g);},1000);};b.showConfirmation=function(h){var f=c.sbAutoVars[h];
var g=(f.confirmMsg!=""?f.confirmMsg:"Thanks!");if(f.position==="sb-banner-top"){d("#sb-"+h+" .sb-box-rows").addClass("sb-full-width").html(g);}else{d("#sb-"+h+" .sb-first-row").html(g);
}};b.init();c.sbAutomation=b;})(window,document,jQuery);