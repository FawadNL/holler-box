(function(c,a,d,e){var b={};b.init=function(){b.cacheSelectors();};b.cacheSelectors=function(){b.floatingBtn=a.getElementById("sb-floating-btn");b.notificationBox=a.getElementById("sb-notification-box");
b.banner=a.getElementById("sb-banner");b.chatBox=a.getElementById("sb-chat");b.noteOptin=a.getElementById("sb-note-optin");b.delay=(c.sbAutoVars.delay?parseInt(c.sbAutoVars.delay):"1000");
b.firstRow=a.getElementById("sb-first-row");b.newVisitor=true;b.noteInteracted=false;b.noteHidden=false;if(b.notificationBox){b.doNotification();}if(b.banner){b.doBanner();
}};b.doNotification=function(){b.noteVisitorChecks();};b.doBanner=function(){};b.noteVisitorChecks=function(){if(b.getCookie("sb_note_int")==="true"&&c.sbAutoVars.noteInteracted){b.noteInteracted=true;
b.currentContent=c.sbAutoVars.noteInteracted;}else{if(b.getCookie("sb_visit")===""){var f=b.setCookie("sb_visit",Date.now(),parseInt(c.sbAutoVars.expires));
b.currentContent=c.sbAutoVars.noteDefault;}else{b.newVisitor=false;b.currentContent=(c.sbAutoVars.noteReturning?c.sbAutoVars.noteReturning:c.sbAutoVars.noteDefault);
}}setTimeout(function(){b.showNote(b.currentContent);b.noteListeners();},b.delay);};b.noteListeners=function(){d("body").on("click",".sb-close",b.hideItem).on("click","#sb-submit-email",b.emailSubmitted).on("click","#sb-floating-btn",b.toggleHide).on("click",".sb-interaction",b.interactionLink).on("click","#sb-submit-text",b.sendText);
d("#sb-text-input").on("keypress",b.submitChatTextOnEnter);d("#sb-email-input").on("keypress",b.submitEmailOnEnter);};b.showNote=function(f){b.firstRow.innerHTML=f.content;
if(f.hideFirst==="true"||c.localStorage.getItem("sb_hide_note")==="true"){b.transitionOut(b.notificationBox);if(f.showBtn!="false"){b.transitionIn(b.floatingBtn);
}}else{b.transitionIn(b.notificationBox);if(f.showBtn!="false"){b.transitionOut(b.floatingBtn);}}if(f.showOptin==="true"&&f.showChat!="true"){b.transitionIn(b.noteOptin);
var g=a.getElementById("sb-email-input");if(g){g.setAttribute("placeholder",f.placeholder);}}if(f.showBtn==="false"){b.hide(b.floatingBtn);}if(f.showChat==="true"){b.transitionIn(b.chatBox);
}};b.setCookie=function(g,j,h){var i=new Date();i.setTime(i.getTime()+(h*24*60*60*1000));var f="expires="+i.toUTCString();a.cookie=g+"="+j+";"+f+";path=/";
return j;};b.getCookie=function(h){var g=h+"=";var k=decodeURIComponent(a.cookie);var f=k.split(";");for(var j=0;j<f.length;j++){var l=f[j];while(l.charAt(0)==" "){l=l.substring(1);
}if(l.indexOf(g)==0){return l.substring(g.length,l.length);}}return"";};b.hideItem=function(f){b.toggleHide();return false;};b.toggleHide=function(){var f=c.localStorage.getItem("sb_hide_note");
if(f==="true"){c.localStorage.removeItem("sb_hide_note");}else{c.localStorage.setItem("sb_hide_note","true");setTimeout(function(){b.clearChat();},1000);
}b.showNote(b.currentContent);};b.transitionIn=function(f){f.style.display="block";setTimeout(function(){f.classList="sb-transition-in";},1);setTimeout(function(){f.classList="sb-show";
},100);};b.transitionOut=function(f){f.classList="sb-transition-out";setTimeout(function(){f.classList="sb-hide";f.removeAttribute("style");},500);};b.show=function(f){f.style.display="block";
f.classList="sb-show";};b.hide=function(f){f.classList="sb-hide";f.removeAttribute("style");};b.checkExistingMsg=function(){var h=c.localStorage.getItem("sb-full-msg");
if(h&&h!=""){var g=h.split("/n");for(var f=0;f<g.length;f++){d(".sb-box-rows").append('<div class="sb-row sb-visitor-row">'+g[f]+"</div>");}b.showEmailSubmit();
}};b.submitChatTextOnEnter=function(f){if(f.target.value&&f.target.value!=""&&f.keyCode==13){b.submitText(f.target.value);f.target.value="";}};b.submitEmailOnEnter=function(f){if(f.target.value&&f.target.value!=""&&f.keyCode==13){b.emailSubmitted();
}};b.sendText=function(f){var g=d("#sb-text-input").val();if(g&&g!=""){b.submitText(g);d("#sb-text-input").val("").focus();}};b.submitText=function(g){var f=c.localStorage.getItem("sb-full-msg");
d(".sb-box-rows").append('<div class="sb-row sb-visitor-row">'+g+"</div>");if(f){f+="/n"+g;}else{f=g;}c.localStorage.setItem("sb-full-msg",f);setTimeout(function(){b.showEmailSubmit();
},5000);};b.showEmailSubmit=function(){var f=d(".sb-email-row");if(f.hasClass("sb-show")){return;}f.removeClass("sb-hide").addClass("sb-show");f.prepend('<span class="sb-away-msg">'+c.sbAutoVars.noteDefault.optinMsg+"</span>");
d("#sb-email-input").focus();};b.emailSubmitted=function(h){var f=d("#sb-email-input").val();if(!f||f.indexOf("@")===-1||f.indexOf(".")===-1){alert("Something is wrong with your email, please try again.");
return;}var g=c.localStorage.getItem("sb-full-msg");b.sendMsg(f,g);};b.sendMsg=function(f,g){d.ajax({method:"GET",url:c.sbAutoVars.ajaxurl,data:{email:f,msg:g,action:"sb_send_email",nonce:c.sbAutoVars.sbNonce}}).done(function(h){console.log(h);
b.clearChat();b.showConfirmation();b.interacted({event:"message_sent"});}).fail(function(h){console.log(h);});};b.clearChat=function(){if(!d(b.chatBox).hasClass("sb-hide")){c.localStorage.removeItem("sb-full-msg");
d(".sb-visitor-row, .sb-away-msg").remove();}b.hide(b.noteOptin);};b.interactionLink=function(f){b.interacted({event:"link_clicked",details:{href:f.target.href}});
};b.interacted=function(f){var g={action:"sb_track_event",nonce:c.sbAutoVars.sbNonce,event:f.event};if(f.data){g.details=f.details;}d.ajax({method:"GET",url:c.sbAutoVars.ajaxurl,data:g}).done(function(h){console.log(h);
}).fail(function(h){console.log(h);});b.setCookie("sb_note_int","true",1);};b.showConfirmation=function(){b.firstRow.innerHTML=b.currentContent.confirmMsg;
};b.init();c.sbAutomation=b;})(window,document,jQuery);