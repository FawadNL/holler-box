(function(c,a,d,e){var b={};b.init=function(){b.newVisitor=false;b.checkCookie();if(c.hollerVars.active){b.doActive(c.hollerVars.active);}};b.checkCookie=function(){if(b.getCookie("hwp_visit")===""){b.setCookie("hwp_visit",Date.now(),parseInt(c.hollerVars.expires));
b.setCookie("hwp_new","true",1);b.newVisitor=true;}else{if(b.getCookie("hwp_new")!=""){b.newVisitor=true;}}};b.doActive=function(g){for(var f=0;f<g.length;
f++){b.doChecks(g[f]);}};b.doChecks=function(k){var h=a.getElementById("hwp-"+k);if(!h){return;}var j=c.hollerVars[k];if(!j.visitor){return;}if(j.visitor==="new"&&b.newVisitor!=true){return;
}if(j.visitor==="returning"&&b.newVisitor!=false){return;}var g=b.getCookie("hwp_"+k+"_shown");if(j.showSettings==="hide_for"&&g==="true"){return;}else{if(j.showSettings==="hide_for"&&g===""){var i=(j.hideForDays?parseInt(j.hideForDays):1);
b.setCookie("hwp_"+k+"_shown","true",i);}}if(j.showSettings==="interacts"&&b.getCookie("hwp_"+k+"_int")!=""){return;}b.floatingBtn=a.getElementById("hwp-floating-btn");
b.noteListeners(k);if(j.bgColor){h.style.backgroundColor=j.bgColor;}if(j.btnColor1){d("#hwp-"+k+" .hwp-email-btn, #hwp-floating-btn").css("background-color",j.btnColor1);
}if(j.display_when!="scroll"){var f=(j.display_when==="delay"?parseInt(j.delay):0);setTimeout(function(){b.showNote(k);if(b.getCookie("hwp-"+k+"_hide")!="true"){b.countNoteShown(k);
}},f*1000);}else{b.detectScroll(k);}};b.noteListeners=function(f){d("body").on("click",".hwp-close",b.hideItem).on("click","#hwp-floating-btn",b.btnClick).on("click","#hwp-"+f+" a",b.interactionLink).on("click",".hwp-text i",b.sendText).on("click","#hwp-"+f+" .hwp-email-btn",b.emailSubmitClick);
d(".hwp-text-input").on("keypress",b.submitChatTextOnEnter);d("#hwp-"+f+" .hwp-email-input").on("keypress",b.submitEmailOnEnter);};b.detectScroll=function(f){d(c).scroll(b.debounce(function(){var h=d(c).scrollTop(),i=d(a).height(),g=d(c).height();
var j=0.5;if((h/(i-g))>j&&!b.show["hwp-"+f]){b.showNote(f);b.show["hwp-"+f]=true;}},250));};b.showNote=function(h){var f=c.hollerVars[h];var g=a.getElementById("hwp-"+h);
if(b.getCookie("hwp-"+h+"_hide")==="true"){b.transitionOut(g);if(f.hideBtn!="1"&&f.position!="holler-banner"){b.transitionIn(b.floatingBtn);}}else{b.transitionIn(g);
d("#hwp-"+h+" .hwp-first-row").html(f.content);if(f.hideBtn!="1"&&f.position!="holler-banner"){b.transitionOut(b.floatingBtn);}if(f.showEmail==="1"&&f.showChat!="1"){b.showEmailSubmit(h);
}if(f.showChat==="1"){b.transitionIn(a.querySelector("#hwp-"+h+" .hwp-chat"));}}if(f.hideBtn==="1"){b.hide(b.floatingBtn);}if(f.position==="holler-banner"&&b.getCookie("hwp-"+h+"_hide")!="true"){b.toggleBnrMargin(h);
}if(f.hide_after==="delay"){setTimeout(function(){b.transitionOut(g);},parseInt(f.hide_after_delay)*1000);}};b.setCookie=function(g,j,h){var i=new Date();
i.setTime(i.getTime()+(h*24*60*60*1000));var f="expires="+i.toUTCString();a.cookie=g+"="+j+";"+f+";path=/";return j;};b.getCookie=function(h){var g=h+"=";
var k=decodeURIComponent(a.cookie);var f=k.split(";");for(var j=0;j<f.length;j++){var l=f[j];while(l.charAt(0)==" "){l=l.substring(1);}if(l.indexOf(g)==0){return l.substring(g.length,l.length);
}}return"";};b.debounce=function(g,f){var h=null;return function(){var j=this,i=arguments;clearTimeout(h);h=setTimeout(function(){g.apply(j,i);},f);};};
b.toggleBnrMargin=function(h,g){if(g&&g===true){d("body").css("margin-top","");}else{var f=d("#hwp-"+h).outerHeight();d("body").css("margin-top",f);}};
b.hideItem=function(g){g.stopImmediatePropagation();var f=d(g.target).closest(".holler-box");var h=f.attr("id").split("-")[1];b.toggleHide(h);if(f.hasClass("holler-banner")){b.toggleBnrMargin(h,true);
}return false;};b.btnClick=function(f){f.stopImmediatePropagation();var g=d(this).data("id");b.toggleHide(g);};b.toggleHide=function(g){var f=b.getCookie("hwp-"+g+"_hide");
if(f==="true"){b.setCookie("hwp-"+g+"_hide","true",-1);}else{b.setCookie("hwp-"+g+"_hide","true",1);}b.showNote(g);};b.transitionIn=function(f){f.style.display="block";
setTimeout(function(){d(f).addClass("hwp-transition-in").removeClass("hwp-hide");},1);setTimeout(function(){d(f).removeClass("hwp-transition-in").addClass("hwp-show");
},300);};b.transitionOut=function(f){d(f).addClass("hwp-transition-out").removeClass("hwp-show");setTimeout(function(){d(f).removeClass("hwp-transition-out").addClass("hwp-hide");
d(f).css("display","");},200);};b.show=function(f){f.style.display="block";d(f).removeClass("hwp-hide").addClass("hwp-show");};b.hide=function(f){d(f).removeClass("hwp-show").addClass("hwp-hide");
d(f).css("display","");};b.checkExistingMsg=function(){var h=c.localStorage.getItem("hwp-full-msg");if(h&&h!=""){var g=h.split("/n");for(var f=0;f<g.length;
f++){d("#"+b.activeID+" .hwp-box-rows").append('<div class="hwp-row hwp-visitor-row">'+g[f]+"</div>");}b.showEmailSubmit();}};b.submitChatTextOnEnter=function(f){if(f.target.value&&f.target.value!=""&&f.keyCode==13){var g=d(f.target).closest(".holler-box").attr("id").split("-")[1];
b.submitText(f.target.value,g);f.target.value="";}};b.submitEmailOnEnter=function(f){if(f.target.value&&f.target.value!=""&&f.keyCode==13){var g=d(f.target).closest(".holler-box").attr("id").split("-")[1];
f.preventDefault();b.emailSubmitted(g);}};b.sendText=function(f){f.stopImmediatePropagation();var h=d(f.target).closest(".holler-box").attr("id").split("-")[1];
var g=d("#hwp-"+h+" .hwp-text-input").val();if(g&&g!=""){b.submitText(g,h);d("#hwp-"+h+" .hwp-text-input").val("").focus();}};b.submitText=function(g,h){var f=c.localStorage.getItem("hwp-full-msg");
d("#hwp-"+h+" .hwp-box-rows").append('<div class="hwp-row hwp-visitor-row">'+g+"</div>");if(f){f+="\n"+g;}else{f=g;}c.localStorage.setItem("hwp-full-msg",f);
setTimeout(function(){b.showEmailSubmit(h);},5000);};b.showEmailSubmit=function(i){var f=d("#hwp-"+i+" .hwp-email-row");var g=c.hollerVars[i];if(f.hasClass("hwp-show")){return;
}var h=a.querySelector("#hwp-"+i+" .hwp-email-input");h.setAttribute("placeholder",g.placeholder);d(".hwp-away-msg").remove();d("#hwp-"+i).addClass("has-optin");
f.removeClass("hwp-hide").addClass("hwp-show");f.prepend('<span class="hwp-away-msg">'+g.optinMsg+"</span>");};b.emailSubmitClick=function(f){f.stopImmediatePropagation();
f.preventDefault();var g=d(f.target).closest(".holler-box").attr("id").split("-")[1];b.emailSubmitted(g);};b.emailSubmitted=function(h){var f=d("#hwp-"+h+" .hwp-email-input").val();
if(!f){return;}if(f.indexOf("@")===-1||f.indexOf(".")===-1){alert("Something is wrong with your email, please try again.");return;}if(d("#hwp-"+h+" input[name=hwp_hp]").val()!=""){return;
}if(c.hollerVars[h].emailProvider==="ck"){b.ckSubscribe(f,h);return;}else{if(c.hollerVars[h].emailProvider==="mc"){b.mcSubscribe(f,h);return;}}var g=c.localStorage.getItem("hwp-full-msg");
b.sendMsg(f,g,h);};b.ckSubscribe=function(g,j){var f=c.hollerVars[j];var i=d("#hwp-"+j+" .ck-form-id").val();var h="https://api.convertkit.com/v3/forms/"+i+"/subscribe";
d.ajax({method:"POST",url:h,data:{email:g,api_key:f.ckApi}}).done(function(k){b.showConfirmation(j);d("#hwp-"+j+" .hwp-email-row").hide();b.conversion(j);
}).fail(function(k){d("#hwp-"+j+" .hwp-email-row").prepend('<span id="hwp-err">There seems to be a problem, can you try again?</span>');setTimeout(function(){d("#hwp-err").remove();
},3000);console.log(k);});};b.mcSubscribe=function(g,h){var f=d("#hwp-"+h+" .mc-list-id").val();if(!f){alert("MailChimp list ID is missing.");return;}d.ajax({method:"GET",url:c.hollerVars.ajaxurl,data:{email:g,list_id:f,action:"hwp_mc_subscribe",nonce:c.hollerVars.hwpNonce}}).done(function(i){b.showConfirmation(h);
d("#hwp-"+h+" .hwp-email-row").hide();b.conversion(h);}).fail(function(i){console.log(i);});};b.sendMsg=function(f,g,h){d.ajax({method:"GET",url:c.hollerVars.ajaxurl,data:{email:f,id:h,msg:g,action:"hwp_send_email",nonce:c.hollerVars.hwpNonce}}).done(function(i){b.clearChat(h);
b.showConfirmation(h);b.conversion(h);}).fail(function(i){console.log(i);});};b.clearChat=function(f){if(!d("#hwp-"+f+" .hwp-chat").hasClass("hwp-hide")){c.localStorage.removeItem("hwp-full-msg");
d("#hwp-"+f+" .hwp-visitor-row, #hwp-"+f+" .hwp-away-msg").remove();}b.hide(d("#hwp-"+f+" .hwp-email-row"));};b.interactionLink=function(f){f.stopImmediatePropagation();
var g=d(f.target).closest(".holler-box").attr("id").split("-")[1];b.conversion(g);};b.conversion=function(g){var f={action:"hwp_track_event",nonce:c.hollerVars.hwpNonce,id:g};
d.ajax({method:"GET",url:c.hollerVars.ajaxurl,data:f}).done(function(h){}).fail(function(h){console.log(h);});b.setCookie("hwp_"+g+"_int","true",1);};b.showConfirmation=function(h){var f=c.hollerVars[h];
var g=(f.confirmMsg!=""?f.confirmMsg:"Thanks!");if(f.position==="holler-banner"){d("#hwp-"+h+" .hwp-box-rows").addClass("hwp-full-width").html(g);}else{d("#hwp-"+h+" .hwp-first-row").html(g);
}if(f.showChat==="1"){b.clearChat(h);}};b.countNoteShown=function(g){var f={action:"hwp_track_view",nonce:c.hollerVars.hwpNonce,id:g};d.ajax({method:"GET",url:c.hollerVars.ajaxurl,data:f}).done(function(h){}).fail(function(h){});
};b.init();c.hollerbox=b;})(window,document,jQuery);